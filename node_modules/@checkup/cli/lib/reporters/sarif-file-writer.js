"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getOutputPath = exports.writeOutputFile = exports.DEFAULT_OUTPUT_FILENAME = exports.TODAY = void 0;
const fs_extra_1 = require("fs-extra");
const path_1 = require("path");
const core_1 = require("@checkup/core");
const chalk_1 = require("chalk");
const date = require('date-and-time');
exports.TODAY = date.format(new Date(), 'YYYY-MM-DD-HH_mm_ss');
exports.DEFAULT_OUTPUT_FILENAME = `checkup-report-${exports.TODAY}.sarif`;
function writeOutputFile(outputFile, cwd, result) {
    let outputPath = getOutputPath(outputFile, cwd);
    fs_extra_1.writeJsonSync(outputPath, result);
    core_1.ui.log(chalk_1.yellow(outputPath));
}
exports.writeOutputFile = writeOutputFile;
function getOutputPath(outputFile, cwd = '') {
    if (/{default}/.test(outputFile)) {
        outputFile = outputFile.replace('{default}', exports.DEFAULT_OUTPUT_FILENAME);
    }
    let outputPath = path_1.isAbsolute(outputFile)
        ? outputFile
        : path_1.resolve(cwd, outputFile || `${exports.DEFAULT_OUTPUT_FILENAME}.sarif`);
    let dir = path_1.dirname(outputPath);
    if (!fs_extra_1.existsSync(dir)) {
        fs_extra_1.mkdirpSync(dir);
    }
    return outputPath;
}
exports.getOutputPath = getOutputPath;
//# sourceMappingURL=sarif-file-writer.js.map